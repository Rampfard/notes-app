!function(t){var e={};function s(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);class n{constructor(t){this.name=t,this.store=window.localStorage,this.items}getLocalStorage(){return this.items||JSON.parse(this.store.getItem(this.name)||"[]")}setLocalStorage(t){this.store.setItem(this.name,JSON.stringify(this.items=t))}setTheme(t){this.store.setItem("Theme",t)}getTheme(){return this.store.getItem("Theme")}updateItem(t){const e=t.id,s=this.getLocalStorage().map(s=>s.id!==e?s:t);this.setLocalStorage(s)}findItem(t){return this.getLocalStorage().find(e=>e.id===t)}addItem(t){const e=this.getLocalStorage();e.push(t),this.setLocalStorage(e)}removeItem(t){const e=this.getLocalStorage().filter(e=>e.id!==t);this.setLocalStorage(e)}removeAll(){this.setLocalStorage([])}removeCompleted(){const t=this.getLocalStorage();if(t.length<1)return;const e=t.filter(t=>!t.isCompleted);this.setLocalStorage(e)}setCompleteStatus(t){let e;const s=this.getLocalStorage();if(e="complete"===t,s.length<1)return;const n=s.map(t=>(t.isCompleted=e,t.options&&t.options.forEach(t=>t.isCompleted=e),t));this.setLocalStorage(n)}getItemsCount(){const t=this.getLocalStorage(),e=t.filter(t=>t.isCompleted).length;return{notesQuantity:t.length,completedNotesQuantity:e}}}const i=(t,e=document)=>e.querySelector(t),o=(t,e=document)=>e.querySelectorAll(t),a=t=>document.createElement(t);class c{constructor(t,e){this.type=e,this.description=t}createNotification(){const t=a("div");return t.classList.add("notification"),this.type&&t.classList.add(this.type),t.innerText=this.description,t}}class r{constructor(t,e,s){this.actions=s,this.noteTemplate=t,this.formInstance=e,this.mainSection=i(".main"),this.noteList=i(".notes"),this.tabs=i(".notes-tabs"),this.createNoteBtn=i("#create-note"),this.searchInput=i("#search-input"),this.form=i("#form"),this.editMenu=i(".header__edit"),this.settingsMenu=i(".header__settings"),this.tabs=i(".notes-tabs"),this.backdrop=i(".backdrop"),this.notifications=i("#notifications"),this.contextMenuTemplate=i("#context-menu-template"),this.noteDetail=i("#note-detail"),this.themeModal=i("#theme-modal"),this.tabsBtn=i("#tabs-btn"),this.startScreen=i(".start-screen"),this.infoBlock=i(".info-block"),this.kitty=i(".kitty"),this.bindEventsToElements()}createNote(t){if(!t)return;this.startScreen&&this.startScreen.classList.add("hiden");const e=this.noteTemplate.createNote(t);this.noteList.insertAdjacentElement("afterbegin",e),this.resizeAllNotes()}createNotification(t,e){const s=new c(t,e).createNotification();this.notifications.append(s),setTimeout(()=>{s.remove()},4e3)}resizeNote(t){const e=this.noteList,s=parseInt(window.getComputedStyle(e).getPropertyValue("grid-auto-rows")),n=parseInt(window.getComputedStyle(e).getPropertyValue("grid-row-gap")),o=Math.ceil((i(".note__inner",t).getBoundingClientRect().height+n)/(s+n));t.style.gridRowEnd="span "+o}resizeAllNotes(){o(".note",this.noteList).forEach(t=>{this.resizeNote(t)})}editNote(t){t.classList.add("editing");const e=a("textarea");e.classList.add("input","form-input","edit"),e.value=t.innerText,t.appendChild(e),e.focus()}editNoteFinished(t,e){const s=i("#"+t),n=i("textarea",s);e.innerText=n.value,e.classList.remove("editing"),n.remove(),this.resizeAllNotes()}setNotesActiveStatus(t){o(".note",this.noteList).forEach(e=>{t&&e.id!==t||(e.classList.add("completed"),o(".note-option",e).forEach(t=>t.classList.add("completed")))})}setNotesInactiveStatus(t){o(".note",this.noteList).forEach(e=>{t&&e.id!==t||(e.classList.remove("completed"),o(".note-option",e).forEach(t=>t.classList.remove("completed")))})}filterNotesByType(t){o(".note",this.noteList).forEach(e=>{const s=e.dataset.type;"all"!==t?"completed"===t&&e.classList.contains(t)?e.classList.remove("hide"):s!==t?e.classList.add("hide"):e.classList.remove("hide"):e.classList.remove("hide")})}copyToClipboard(t){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(t);{let e=document.createElement("textarea");return e.value=t,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select(),new Promise((t,s)=>{document.execCommand("copy")?t():s(),e.remove()})}}createContextMenu(t,e){const s=this.contextMenuTemplate.content.firstElementChild.cloneNode(!0);"todo"===e.dataset.type&&(i("#copy-description-btn",s).remove(),i("#edit-description-btn",s).remove());const n=t.clientY,o=t.clientX,a=e.getBoundingClientRect();let c=n-a.top,r=o-a.left;o>document.documentElement.getBoundingClientRect().width/2&&(r-=e.clientWidth/2),s.style.top=c+"px",s.style.left=r+"px",s.addEventListener("click",t=>{this.contextMenuHandler(t,e)},!0),this.contextMenu=s,e.append(s)}contextMenuHandler(t,e){const s=e.id;switch(t.target.closest("button").id){case"remove-note-btn":this.actions.removeNote(s),e.remove(),this.createNotification("Note removed"),this.actions.getItemsCount().notesQuantity<1&&this.startScreen.classList.remove("hiden");break;case"select-text-btn":this.contextMenu.remove(),this.selectNoteText(s);break;case"complete-note-btn":if(e.classList.contains("completed"))e.classList.remove("completed"),this.actions.toggleCompleteStatus(s),this.setNotesInactiveStatus(s);else{let t=[...o(".note-option",e)];t.length>0&&(t=t.map(t=>t.id)),this.actions.toggleCompleteStatus(s,t),this.setNotesActiveStatus(s)}break;case"edit-title-btn":this.editNote(i(".note__title",e)),this.contextMenu.remove();break;case"edit-description-btn":this.editNote(i(".note__description",e)),this.contextMenu.remove();break;case"copy-description-btn":this.contextMenu.remove(),this.copyToClipboard(i(".note__description",e).textContent),this.createNotification("Description copied!");break;case"copy-title-btn":this.contextMenu.remove(),this.copyToClipboard(i(".note__title",e).textContent),this.createNotification("Title copied!")}}editMenuHandler(t){const e=t.target;switch(e.id){case"edit-btn":e.parentNode.classList.toggle("active");break;case"remove-all-btn":if(!confirm("Are You sure You want to delete all notes?"))return;this.actions.removeAll(),this.noteList.innerHTML="",this.startScreen.classList.remove("hiden"),this.createNotification("All notes removed","succsess");break;case"remove-completed-btn":if(!confirm("Are You sure You want to delete completed notes?"))return;this.actions.removeCompleted(),o(".note",this.noteList).forEach(t=>{t.classList.contains("completed")&&t.remove()}),this.createNotification("All completed notes removed","succsess");break;case"mark-notes-btn":if("false"!==e.dataset.complete){this.actions.setAllIncompleted(),this.setNotesInactiveStatus(),e.dataset.complete=!1,e.innerText="Mark all as completed";break}this.actions.setAllCompleted(),this.setNotesActiveStatus(),e.dataset.complete=!0,e.innerText="Mark all as incompleted"}}selectNoteText(t){const e=i("#"+t);this.noteDetail.innerHTML="";const s=e.cloneNode(!0);s.classList.add("select"),this.noteDetail.appendChild(s),o(e,s,()=>{this.mainSection.dataset.state="detail",e.style.opacity=0});const n=t=>{t.target.classList.contains("note-detail")&&o(s,e,()=>{this.mainSection.dataset.state="gallery",e.style.opacity="",s.remove(),this.noteDetail.removeEventListener("click",n)})};function o(t,e,s){const n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),o=n.left-i.left,a=n.top-i.top,c=n.width/i.width,r=n.height/i.height;s(),e.animate([{transform:`translateX(${o}px) translateY(${a}px) scaleX(${c}) scaleY(${r})`},{transform:"none"}],{duration:600,easing:"cubic-bezier(0.2, 0, 0.3, 1)"})}this.noteDetail.addEventListener("click",n)}settingsMenuHandler(t){const e=t.target;switch(e.id){case"settings-btn":this.settingsMenu.classList.contains("expand")?(this.settingsMenu.classList.remove("expand"),this.settingsMenu.classList.add("shrink")):(this.settingsMenu.classList.remove("shrink"),this.settingsMenu.classList.add("expand")),e.classList.toggle("active");break;case"change-theme-btn":this.backdrop.classList.add("shown"),this.showThemeModal();break;case"info-btn":this.backdrop.classList.add("shown"),this.infoBlock.classList.add("shown");break;case"kitty-btn":if(this.kitty.classList.contains(".shown"))return;this.kitty.classList.add("shown"),setTimeout(()=>{this.kitty.classList.remove("shown")},2e3)}}showThemeModal(){this.themeModal.classList.add("shown")}connectSettingsMenu(){this.settingsMenu.addEventListener("click",t=>{this.settingsMenuHandler(t)})}connectThemeModal(){this.themeModal.addEventListener("click",t=>{t.target.checked&&(this.actions.setTheme(t.target.id),document.body.className=""+t.target.id)})}connectContextMenu(){this.noteList.addEventListener("contextmenu",t=>{t.preventDefault();const e=t.target;if(!e.closest(".context-menu")&&e.closest(".note")&&!e.closest(".context-menu")){const s=e.closest(".note");this.contextMenu&&this.contextMenu.remove(),this.createContextMenu(t,s)}})}connectSearchHandler(){this.searchInput.addEventListener("input",t=>{o(".note",this.noteList).forEach(e=>{const s=t.target.value.trim();i(".note__title",e).textContent.trim().toLowerCase().includes(s.toLowerCase())?e.classList.remove("hide"):e.classList.add("hide")}),this.resizeAllNotes()})}connectShowFormBtn(t){t.addEventListener("click",()=>{this.backdrop.classList.add("shown"),this.form.classList.add("shown")})}connectTabsHandler(){this.tabs.addEventListener("click",t=>{const e=t.target;e.closest(".notes-tab")&&(o(".notes-tab").forEach(t=>t.classList.remove("active")),e.classList.add("active"),i("span",this.tabsBtn).textContent=e.textContent,this.filterNotesByType(e.dataset.type))})}connectDoubleClickToNoteList(){this.noteList.addEventListener("dblclick",t=>{const e=t.target;e.closest(".note")&&(e.classList.contains("note__description")||e.classList.contains("note__title"))&&this.editNote(e)})}connectBodyClickHandler(){document.body.addEventListener("click",t=>{this.contextMenu&&!t.target.closest(".context-menu")&&this.contextMenu.remove(),t.target.classList.contains("close-btn")&&this.backdrop.classList.remove("shown"),t.target.closest(".header__edit")||i(".header__edit").classList.remove("active"),t.target.classList.contains("backdrop")&&(this.backdrop.classList.remove("shown"),this.form.classList.remove("shown"),this.themeModal.classList.remove("shown"),this.infoBlock.classList.remove("shown")),this.settingsMenu.classList.contains("expand")&&!t.target.closest(".header__settings")&&(this.settingsMenu.classList.remove("expand"),this.settingsMenu.classList.add("shrink"),this.settingsMenu.firstElementChild.classList.remove("active")),window.matchMedia("(max-width: 640px)")&&!t.target.closest(".tabs-container")&&(this.tabs.classList.remove("active"),this.tabsBtn.classList.remove("active"))})}connectEditMenu(){this.editMenu.addEventListener("click",t=>{const{notesQuantity:e}=this.actions.getItemsCount();e<1?this.editMenu.classList.add("edit-disabled"):this.editMenu.classList.remove("edit-disabled"),this.editMenuHandler(t)})}connectSubmitFormHandler(){this.formInstance.form.addEventListener("submit",t=>{t.preventDefault();const e=this.formInstance.getFormData();e&&(this.createNote(e),this.actions.addItem(e),this.form.classList.remove("shown"),this.backdrop.classList.remove("shown"),this.createNotification(e.type+" created!","success"))})}connectToggleCompleteStatusHandler(){this.noteList.addEventListener("click",t=>{if(!t.target.closest(".note"))return;const e=t.target.closest(".note-option"),s=t.target.closest(".note").id;if(e){const t=o(".note-option",e.parentNode);e.classList.toggle("completed");const n=o(".note-option.completed",e.parentNode);n.length===t.length?e.closest(".note").classList.add("completed"):e.closest(".note").classList.remove("completed");const i=[...n].map(t=>t.id);this.actions.toggleCompleteStatus(s,i)}})}connectEditNoteSaveHandler(){this.noteList.addEventListener("blur",t=>{const e=t.target,s=e.closest(".note").id,n=e.value;""!==n.trim()&&(t.target.closest(".note__title")&&(this.actions.saveNoteChanges(s,n,"title"),this.editNoteFinished(s,e.parentNode)),t.target.closest(".note__description")&&(this.actions.saveNoteChanges(s,n,"description"),this.editNoteFinished(s,e.parentNode)))},!0)}connectEditNoteCancel(){this.noteList.addEventListener("keyup",t=>{const e=t.target;27===t.keyCode&&(e.value=e.parentNode.textContent.trim(),e.blur())})}connectMansornyLayoutResize(){let t;window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(()=>{this.resizeAllNotes()},200)})}connectTabsBtn(){this.tabsBtn.addEventListener("click",t=>{this.tabsBtn.classList.toggle("active"),this.tabsBtn.nextElementSibling.classList.toggle("active")})}bindEventsToElements(){this.connectBodyClickHandler(),this.connectSearchHandler(),this.connectTabsHandler(),this.connectDoubleClickToNoteList(),this.connectToggleCompleteStatusHandler(),this.connectContextMenu(),this.connectEditMenu(),this.connectEditNoteSaveHandler(),this.connectEditNoteCancel(),this.connectSubmitFormHandler(),this.connectShowFormBtn(this.createNoteBtn),this.connectShowFormBtn(i("button",this.startScreen)),this.connectTabsBtn(),this.connectSettingsMenu(),this.connectThemeModal(),this.connectMansornyLayoutResize()}init(t){const e=this.actions.getTheme();null!==e&&(document.body.className=e,i("#"+e).checked=!0),t.length>0&&(this.noteList.innerHTML="",t.forEach(t=>{this.createNote(t)})),this.resizeAllNotes()}}class l{constructor(t){this.form=i(t),this.titleInput=i('input[name="note-title"]',this.form),this.descriptionInput=i("textarea",this.form),this.formBody=i(".form__body",this.form),this.formSelectors=o('input[type="radio"]',this.form),this.submitButton=i("#create-btn",this.form),this.formType="note",this.connectInputHandler(this.titleInput),this.connectInputHandler(this.descriptionInput),this.connectChangeBodyHandler(),this.connectCloseBtnHandler()}getFormData(){const t=o(".option p",this.form),e={id:"n"+Math.random().toString().slice(4),date:`${(new Date).toDateString()} ${(new Date).toLocaleTimeString()}`,type:this.formType,isCompleted:!1};if(this.validateForm(t,this.formType))return e.title=this.titleInput.value,this.descriptionInput&&(e.description=this.descriptionInput.value),t.length>0&&(e.options=[...t].map(t=>({text:t.textContent,isCompleted:!1,id:"opt"+Math.random().toString().slice(4)}))),this.clearForm(),e}validateForm(t,e){if(!this.isValid(this.titleInput))return this.titleInput.parentNode.classList.add("invalid"),!1;if(this.descriptionInput&&!this.isValid(this.descriptionInput))return this.descriptionInput.parentNode.classList.add("invalid"),!1;if(t.length<1&&"note"!==e){const t=a("div");return t.classList.add("form-message","form__message--invalid"),t.innerText="You need to add at least 1 option",this.formBody.append(t),setTimeout(()=>{t.remove()},4e3),!1}return!0}isValid(t){return""!==t.value.trim()}clearForm(){this.titleInput.value="",this.descriptionInput&&(this.descriptionInput.value=""),o(".option",this.form).forEach(t=>t.remove())}changeFormBody(t){this.formType=t.target.dataset.type,this.formBody.innerHTML="",this.createFormBody(this.formType)}createFormBody(t){const e=a("div");e.classList.add("options-control");const s=a("ul");if(s.classList.add("options-list"),"todo"===t&&s.classList.add("options-list--todo"),"targets"===t||"note"===t){const e=a("div");if(e.classList.add("form-control"),e.innerHTML='\n\t\t\t\t<label>Note Description</label>\n\t\t\t\t<textarea class="input form-input" placeholder="Enter description"></textarea>\n\t\t\t',this.descriptionInput=i("textarea",e),this.connectInputHandler(this.descriptionInput),this.formBody.append(e),"note"===t)return}else this.descriptionInput=null;e.innerHTML='\n\t\t\t<input class="input form-input" placeholder="Enter Your task" type="text">\n\t\t\t<button type="button" class="btn form-btn">Add Option</button>\n    ';i("button",e).addEventListener("click",this.createOption.bind(this)),this.formBody.append(s,e)}createOption(t){t.preventDefault();const e=i(".options-list",this.formBody),s=i("input",this.formBody);if(""===s.value.trim())return;const n=a("li");n.classList.add("option");const o=a("p");o.textContent=s.value;const c=a("button");c.classList.add("btn","delete-btn"),c.innerText="X",c.addEventListener("click",t=>{t.target.parentNode.remove()}),n.append(o,c),e.append(n),s.value=""}connectChangeBodyHandler(){this.formSelectors.forEach(t=>t.addEventListener("change",this.changeFormBody.bind(this)))}connectInputHandler(t){t.addEventListener("blur",()=>{this.isValid(t)?t.parentNode.classList.remove("invalid"):t.parentNode.classList.add("invalid")})}connectCloseBtnHandler(){i(".close-btn",this.form).addEventListener("click",()=>this.form.classList.remove("shown"))}}class d{constructor(){var t,e,s;s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],(e="months")in(t=this)?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}createNote(t){const e=a("li");e.classList.add("note"),"note"!==t.type&&e.classList.add(t.type),t.isCompleted&&e.classList.add("completed");const{title:s,type:n,id:o}=t;e.dataset.type=n,e.id=o;const[c,r,l]=t.date.split(" ");e.innerHTML=`\n\t\t\t<div class="note__inner">\n\t\t\t\t<h2 class="note__title">\n\t\t\t\t\t${s}\n\t\t\t\t</h2>\n\t\t\t\t<div class="note__content"></div>\n\t\t\t\t<div class="note__info">\n\t\t\t\t\t<div class="note__date">${r} ${l}</div>\n\t\t\t\t\t<div class="note__type">${n}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;const d=i(".note__content",e);if("todo"!==n){const e=a("p");e.innerText=t.description,e.classList.add("note__description"),d.insertAdjacentElement("afterbegin",e)}return"todo"!==n&&"targets"!==n||this.createOptions(t.options,d),e}createOptions(t,e){const s=a("ul");s.classList.add("note-options"),t.forEach(t=>{const e=a("li");e.classList.add("note-option"),e.innerHTML=`\n\t\t\t\t<span></span>\n\t\t\t\t<p>${t.text}</p>\n\t\t\t`,t.isCompleted&&e.classList.add("completed"),e.id=t.id,s.append(e)}),e.append(s)}}class h{constructor(t){this.store=t}addItem(t){this.store.addItem(t)}saveNoteChanges(t,e,s){const n={...this.store.findItem(t),[s]:e};this.store.updateItem(n)}removeNote(t){this.store.removeItem(t)}removeAll(){this.store.removeAll()}removeCompleted(){this.store.removeCompleted()}setAllIncompleted(){this.store.setCompleteStatus("incomplete")}setAllCompleted(){this.store.setCompleteStatus("complete")}setNoteComplete(t){const e=this.store.findItem(t);e.isCompleted=!0,this.store.updateItem(e)}getItemsCount(){return this.store.getItemsCount()}setTheme(t){this.store.setTheme(t)}getTheme(){return this.store.getTheme("Theme")}toggleCompleteStatus(t,e=[]){const s=this.store.findItem(t);if(!s.options)return s.isCompleted=!s.isCompleted,void this.store.updateItem(s);s.options=s.options.map(t=>e.includes(t.id)?(t.isCompleted=!0,t):(t.isCompleted=!1,t)),e.length===s.options.length?s.isCompleted=!0:s.isCompleted=!1,this.store.updateItem(s)}}window.addEventListener("DOMContentLoaded",()=>{(class{static init(){const t=new d,e=new l(".form"),s=new n("notes"),i=new h(s);new r(t,e,i).init(s.getLocalStorage())}}).init()})}]);